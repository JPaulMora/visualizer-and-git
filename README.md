# Best Practices on using Kony Visualizer with Git

Tips and tricks to use Git with Kony Visualizer projects.

## What to Ignore

The following files can be safely added to your .gitignore file.

    # Autogenerated javascript. It's important to note that jssrc at the project root can be ignored, but resources/customlibs/jsSrc must NOT be ignored because it stores FFI binding code which can only be generated during development.
    /jssrc/*
    !/resources/customlibs/jsSrc
    
    # Starting with Visualizer 8.0 the Ant Contrib Jar used throughout the build process will be regenerated when the build is fired.
    ant-contrib-0.6.jar

    # Binaries.
    /binaries
    *.apk
    *.KAR
    
    # Starting with Vis 7.3 the /sdkplugin.properties file has been moved to /resources/customlibs/sdkplugin.properties and can be automatically re-created by Vis.
    resources/customlibs/sdkplugin.properties

    # Other Visualizer auto-generated files.
    /.webmeta
    middleware.properties
    splashscreenproperties.json
    
    # Visualizer headless build configuration files
    HeadlessBuild.properties
    HeadlessBuild-Global.properties
    
    # Visualizer modules which are automatically re-created when missing
    modules/mbaasconfig.js
    
    # Auxiliary files generated during a build to expose the widget ID's for testing.
    resources/mobile/native/android/values/widgetids.xml
    resources/tablet/native/androidtab/values/widgetids.xml
    
    # NPM dependencies folder when for apps using Cordova. Apparently only needed when not using a global Cordova installation.
    node_modules
    
    # Cordova plugins and platforms directories can be ignored as with any Cordova project.
    cordovatemp
    web/cordova/plugins
    web/cordova/platforms
    
    # Auto-generated temporary internationalization files
    resources/i18n/
    
    # Logs created by building from the command line.
    velocity.log
    
    # Be careful not to ignore these jars or the Android build will break.
    # As far as I can tell they're only generated the first time the project is ever built.
    !resources/customlibs/lib/android/*jar
    !resources/customlibs/lib/tabrcandroid/*jar
    
    # A Logger FFI that gets bundled with each project is auto-generated by Visualizer with each build.
    resources/customlibs/jsSrc/android/com/konylabs/ffi/N_KonyLogger.java
    resources/customlibs/jsSrc/tabrcandroid/com/konylabs/ffi/N_KonyLogger.java
    resources/customlibs/jsSrc/kiosk/KonyLogger.js
    resources/customlibs/jsSrc/kiosk/KonyLogger.xml
    resources/customlibs/jsSrc/windows8/KonyLogger.js
    resources/customlibs/jsSrc/windows8/KonyLogger.xml
    resources/customlibs/jsSrc/winmobile/KonyLogger.js
    resources/customlibs/jsSrc/winmobile/KonyLogger.xml
    resources/customlibs/jsSrc/winphone8/KonyLogger.js
    resources/customlibs/jsSrc/winphone8/KonyLogger.xml
    resources/customlibs/jsSrc/winphone81s/KonyLogger.js
    resources/customlibs/jsSrc/winphone81s/KonyLogger.xml
    resources/customlibs/jsXml/KonyLogger.js
    resources/customlibs/jsXml/KonyLogger.xml

    # A Single Sign-On FFI that gets bundled with each project is auto-generated by Visualizer with each build.
    resources/customlibs/jsSrc/kiosk/SSOFFI.js
    resources/customlibs/jsSrc/kiosk/SSOFFI.xml
    resources/customlibs/jsSrc/windows8/SSOFFI.js
    resources/customlibs/jsSrc/windows8/SSOFFI.xml
    resources/customlibs/jsSrc/winmobile/SSOFFI.js
    resources/customlibs/jsSrc/winmobile/SSOFFI.xml
    resources/customlibs/jsSrc/winphone8/SSOFFI.js
    resources/customlibs/jsSrc/winphone8/SSOFFI.xml
    resources/customlibs/jsSrc/winphone81s/SSOFFI.js
    resources/customlibs/jsSrc/winphone81s/SSOFFI.xml
    resources/customlibs/jsXml/SSOFFI.js
    resources/customlibs/jsXml/SSOFFI.xml

    # A utility FFI that gets bundled with each project is auto-generated by Visualizer with each build.
    resources/customlibs/jsSrc/android/com/konylabs/ffi/ND_binary_util.java
    resources/customlibs/jsSrc/android/com/konylabs/ffi/N_binarydata.java
    resources/customlibs/jsSrc/tabrcandroid/com/konylabs/ffi/ND_binary_util.java
    resources/customlibs/jsSrc/tabrcandroid/com/konylabs/ffi/N_binarydata.java
    resources/customlibs/jsXml/binary.util.js
    resources/customlibs/jsXml/binary.util.xml
    resources/customlibs/jsXml/binarydata.js
    resources/customlibs/jsXml/binarydata.xml    

## Removing Noise

Once you've commited your Visualizer project to your repository for the first time there are a number of files you can safely ignore thereafter. You can't ignore them from the start and not push them to your repo because Visualizer can't re-create them if they're missing. So checking out your project from the repo and trying to open it with Vis will fail. This means **these files must be a part of your repo**.

However, Visualizer has an annoying habit of modifying these files every time the project is opened, other files are changed or the project is built. This means that these will often appear as changes when you run `git status` and so you'll get a lot of "noise" when determining which changes to commit.

To ignore these files after they've been pushed to your repo for the first time use:

    git update-index --assume-unchanged <file>

For convenience you can just copy and execute these lines:

    git update-index --assume-unchanged run.sh
    git update-index --assume-unchanged run.bat
    git update-index --assume-unchanged projectProperties.json
    git update-index --assume-unchanged context.properties
    git update-index --assume-unchanged defaults/defaults.properties
    
## The Empty Directory Problem

When a Vis project is created a lot of empty directories are added to it's structure. Sadly, Git does not version directories, but files *in* directories. So empty directories are not versioned. This means if a brand new project is pushed to a git repo, those empty directories won't be pushed. The problem with this is that when the project is cloned by another developer, they will be unable to open the project. Vis will crash upon failing to find the directory structure it expects.

To get around this problem, you must force Git to push directories to source control. This can be done by adding a `.gitkeep` file to each empty directory. To do so, have a look at project Gitkeep [here](https://github.com/mig82/gitkeep)

### Notes
* Vis appears to be capable of re-creating the directories under `resources/i18n` so no need to keep those.

## Other Candidates for Ignoring

The following is a list of files I've seen Visualizer update on it's own without good reason and so I've yet to validate whether these can be `.gitignore` or not.

These files where updated just by opening a project:

* projectProperties.json
* modules/KonySyncLib.js
* modules/kony_sdk.js

These files were updated by selecting a different environment/cloud in the `Project Settings>Mobile Fabric>MobileFabric Environment` menu option in Visualizer:

* projectprop.xml
* context.properties
* defaults/defaults.properties
* syncclientcode.zip

These files were created by updating a Visualizer 8.1 project for the first time.
* appSettings.xml: Apparently enables builds for the different platforms in the UI. Doesn't seem important.
* projectsplash.xml: Defines the splash screen. Seems part of the project.
* windowsViews.xml: Not a clue

Not sure about this folder yet. It contains stuff -e.g. `Kony_SyncV2-iOS-11.0.zip` and `Kony_SyncV2-Android-4.0.zip`- related to Sync and it was generated when I created the project.
* nativebindings
